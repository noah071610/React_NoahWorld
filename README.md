
<br/>

<div align=center><a href="https://github.com/noah071610/React_NoahWorld"><img src="https://user-images.githubusercontent.com/74864925/120079497-12334a00-c0ef-11eb-9b73-28eaab517f1c.png"/></a></div>

# <div align=center>Noah world Blog</div> 
#### <div align=center>Place to step up.</div>

<br/>

<div align=center>
<img src="https://travis-ci.org/joemccann/dillinger.svg?branch=master"/>&nbsp
  <img src="https://img.shields.io/github/stars/noah071610/React_NoahWorld?style=social"/>&nbsp
  <img src="https://img.shields.io/github/watchers/noah071610/React_NoahWorld?style=social"/>&nbsp
</div>

<br/>

<div align=center>
<img src="https://img.shields.io/badge/Photoshop-31A8FF?style=flat-square&logo=adobe-photoshop&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/HTML5-E34F26?style=flat-square&logo=HTML5&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/CSS3-1572B6?style=flat-square&logo=CSS3&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/SCSS-CC6699?style=flat-square&logo=Sass&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat-square&logo=JavaScript&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/TypeScript-3178C6?style=flat-square&logo=TypeScript&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/React-61DAFB?style=flat-square&logo=React&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Redux-764ABC?style=flat-square&logo=Redux&logoColor=white"/>&nbsp 
<img src="https://img.shields.io/badge/Redux_Saga-999999?style=flat-square&logo=Redux-Saga&logoColor=white"/>&nbsp 
<img src="https://img.shields.io/badge/Styled_components-DB7093?style=flat-square&logo=styled-components&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Antd-0170FE?style=flat-square&logo=Ant-design&logoColor=white"/>&nbsp <br/>
<img src="https://img.shields.io/badge/Node.js-339933?style=flat-square&logo=node-dot-js&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Express-000000?style=flat-square&logo=Express&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Passport-34E27A?style=flat-square&logo=Passport&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Google_Login-4285F4?style=flat-square&logo=Google-Cloud&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/MySQL-4479A1?style=flat-square&logo=MySQL&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Babel-F9DC3E?style=flat-square&logo=Babel&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Webpack-8DD6F9?style=flat-square&logo=Webpack&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Amazon_AWS-232F3E?style=flat-square&logo=Amazon-AWS&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/Linux-FCC624?style=flat-square&logo=Linux&logoColor=white"/>&nbsp
<img src="https://img.shields.io/badge/PM2-2B037A?style=flat-square&logo=PM2&logoColor=white"/>&nbsp
</div>

<br/>

<div align=center>
  <a href="https://github.com/noah071610" target="_blank"><img src="https://image.flaticon.com/icons/png/24/25/25657.png"/></a>&nbsp
  <a href="https://www.instagram.com/salmonchobab" target="_blank"><img src="https://image.flaticon.com/icons/png/24/1409/1409946.png"/></a>&nbsp
  <a href="https://velog.io/@noah071610" target="_blank"><img width="24" src="https://api.faviconkit.com/velog.io/144"/></a>&nbsp
  <a href="noah071610@naver.com"><img width="24" src="https://lh3.googleusercontent.com/proxy/jSPGDpNbX6xztXCy4axN0zvpdCa2wNWkv5TTHCKpfvEGVXeDOZUbpq9GTXFopXYO5z1KDvhPh__zEnUUSZTyy0xuONNtSHSDXIfyGE-T81k"/></a>&nbsp
  <a href="https://velog.io/@noah071610" target="_blank"><img src="https://image.flaticon.com/icons/png/24/3135/3135715.png"/></a>&nbsp
</div>

<br/><br/><br/><br/>


## About Noah World.
#### ë¬´ë¦¬í•˜ì§€ì•ŠëŠ” ê¹”ë”í•œ ë””ìì¸ì„ ëª©í‘œë¡œ ê°œì„¤í•œ ê°œì¸ ë¸”ë¡œê·¸.

<br/>

![jeshoots-com-pUAM5hPaCRI-unsplash](https://user-images.githubusercontent.com/74864925/120084019-e96b7e80-c107-11eb-8e42-d2e4acbc90d2.png)

<br/>

- **í˜ì´ì§€ ì „ë°˜**

ìµœì‹ ê¸€ ìƒë‹¨ ë°°ì¹˜, í•´ì‹œíƒœê·¸ì™€ ê²€ìƒ‰ê¸°ëŠ¥, ë¶€ë¬¸ë³„ íƒ‘ê²Œì‹œê¸€ê³¼ ì¡°íšŒìˆ˜ ,ì¢‹ì•„ìš”ìˆ˜ ,ê²Œì‹œë‚ ì§œë¥¼ ê³µìœ í•©ë‹ˆë‹¤.

- **ì´ìš©ì**

ì´ìš©ìëŠ” ê¸€ì„ ì¦ê¸°ê³  ì¢‹ì•„ìš”ì™€ ëŒ“ê¸€ ê·¸ë¦¬ê³  ëŒ€ëŒ“ê¸€ì„ ì‘ì„±,ìˆ˜ì •,ì‚­ì œ í•  ìˆ˜ ìˆìœ¼ë©° íšŒì›ê°€ì…ì„ í†µí•´ ë¡œê·¸ì¸,ë¡œê·¸ì•„ì›ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. í—ˆë‚˜ ê²Œì‹œê¸€ì€ ì‘ì„±,ìˆ˜ì •,ì‚­ì œê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

ì´ìš©ìëŠ” ì•„ì´ì½˜ì‚¬ì§„ ë³€ê²½ê³¼ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½, íšŒì›íƒˆí‡´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

ì´ìš©ìëŠ” ê°œì¸ í”„ë¡œí•„ ë¶€ë¶„ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ ìµœê·¼ ë³¸ ê²Œì‹œê¸€ê³¼ ëŒ“ê¸€ì„ ì¡°íšŒ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **ê´€ë¦¬ì**

ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì–´ë“œë¯¼ í˜ì´ì§€ë¥¼ ì´ìš©í•´ ê´€ë¦¬ìë§Œ ê²Œì‹œê¸€ì„ ì‘ì„± ìˆ˜ì • ì‚­ì œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br/><br/>

## Summary.

- í”„ë¡œì íŠ¸ ì¸ì› : ì¥í˜„ìˆ˜(Noah) ì™¸ 0ëª…
- í”„ë¡œì íŠ¸ ê¸°ê°„ : 2021/02 ~ 2021/04
- í”„ë¡œì íŠ¸ ì–¸ì–´:

    + ì˜ì–´ (ì „ë°˜ì ì¸ ë¸”ë¡œê·¸)
    + ì¼ë³¸ì–´ (í•œêµ­ì–´ ê°•ì˜ í˜ì´ì§€)
    + í•œêµ­ì–´ (í¬íŠ¸í´ë¦¬ì˜¤ í˜ì´ì§€)

<br/><br/>

## Code Review & Explain about Noah World.

<br/>

### ğŸ“ &nbsp; ëª¨ë°”ì¼ ìœ ì €ë¥¼ ìœ„í•œ ì—­ë™ì ì¸ í—¤ë” ë³€í™˜.

<br/>

### ğŸ“ &nbsp; ì¢‹ì•„ìš”, ëŒ“ê¸€, ì¡°íšŒìˆ˜ ê²Œì‹œë¬¼ ê·¸ë¦¬ê³  í•´ì‹œíƒœê·¸ë¥¼ ë©”ì¸í˜ì´ì§€ì— ë°°ì¹˜.

```javascript
ğŸ“server/routes/post.js

    ...
    
    const getAttributesFromPosts = await Post.findAll({
      order: [["createdAt", "DESC"]],
      attributes: ["id", "hit"],
      include: [
        {
          model: User,
          as: "PostLikers",
          attributes: ["id"],
        },
        {
          model: Comment,
          include: [
            {
              model: User,
              attributes: ["id"],
            },
          ],
        },
      ],
    }).then((result) =>
      result.map((v) => {
        //ì „ì²´ í¬ìŠ¤íŠ¸ì¤‘ ì•„ì´ë””,ì¢‹ì•„ìš”ìˆ˜,ì½”ë©˜íŠ¸ìˆ˜,ì¡°íšŒìˆ˜ ì „ì²´ë¥¼ ë°°ì—´í˜•íƒœë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.
        return [v.id, v.PostLikers.length, v.Comments.length, v.hit];
      })
    );
    // ê°€ì ¸ì˜¨ ê°’ì„ ì›í•˜ëŠ” ê°’ì— ë”°ë¼ ë¯¸ë¦¬ ë¶„ë¥˜í•´ë‘¡ë‹ˆë‹¤.
    const getLikes = await getAttributesFromPosts.map((v, i) => {
      return v[1];
    });
    const getComments = await getAttributesFromPosts.map((v, i) => {
      return v[2];
    });
    const getViews = await getAttributesFromPosts.map((v, i) => {
      return v[3];
    });

    const mostCalculator = (arr, index) =>
      getAttributesFromPosts.filter((v) => {
        //ë°°ì—´ì¤‘ ìµœëŒ€ê°’ì„ êµ¬í•˜ê¸° ìœ„í•´ ì•„ë˜ì˜ ê°’ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
        return v[index] === Math.max.apply(null, arr);
      });
    
    //ê²°ê³¼ê°’ì´ ì´ì¤‘ë°°ì—´ìœ¼ë¡œ ì´ë£¨ì–´ì§„ idê°’ìœ¼ë¡œ ë‚˜ì˜¤ê¸°ë•Œë¬¸ì— [0][0]ì„ ë¶™í˜”ìŠµë‹ˆë‹¤.
    const mostLikedId = await mostCalculator(getLikes, 1)[0][0];
    const mostCommentsId = await mostCalculator(getComments, 2)[0][0];
    const mostViewedId = await mostCalculator(getViews, 3)[0][0];

    //ì›í•˜ëŠ” ê°’ì´ ìµœëŒ€ì¸ ê²Œì‹œê¸€ì— ì•„ì´ë””ë¥¼ ì´ìš©í•´ì„œ DBì•ˆì— ê°’ì„ ì°¾ì•„ì¤ë‹ˆë‹¤.
    const mostLikedPost = await Post.findOne({
      where: {
        id: mostLikedId,
      },
      attributes: {
        exclude: ["content"],
      
      ...
      
    });
    const mostCommentedPost = await Post.findOne({
      where: {
        id: mostCommentsId,
      },
      attributes: {
        exclude: ["content"],
      
      ...
      
    });
    const mostViewedPost = await Post.findOne({
      where: {
        id: mostViewedId,
      },
      attributes: {
        exclude: ["content"],
      
      ...
      
    });
    //ë©”ì¸í˜ì´ì§€ì— ë”°ë¡œ í‘œì‹œí•  í•´ì‹œíƒœê·¸ë„ ìŠì§€ì•Šê³  ê°€ì ¸ì˜µë‹ˆë‹¤.
    const hashtags = await Hashtag.findAll({
      attributes: ["name"],
    });
    res.status(200).json({
    
    ...

```
---

<br/>

### ğŸ“ &nbsp;  WYSIWYGì˜ Markdownì„ ì´ìš©í•œ í’ì„±í•œ í¬ìŠ¤íŒ… êµ¬í˜„.

<br/>

### ğŸ“ &nbsp;  ê²Œì‹œê¸€ì•ˆ í…ìŠ¤íŠ¸ë¡œ ì´ë£¨ì–´ì§„ í‚¤ì›Œë“œë¥¼ ì •ê·œì‹ìœ¼ë¡œ íŒŒì•…í•´ ë§í¬ë¡œ ë³€í™˜.

```javascript
ğŸ“post/[id].tsx
  
  ...
  
    useEffect(() => {
    const tagContent = post?.content?.split(/(#[^\s#+^<]+)/g).map((v) => {
      //ì •ê·œì‹ì„ ì‚¬ìš©í•´ #name ìœ¼ë¡œ ì´ë£¨ì–´ì§„ textë¥¼ ì°¾ì•„ëƒ…ë‹ˆë‹¤.
      if (v.match(/(#.*")/g)) {
        //ìœ„ì§€ê¸€ì—ë””í„°ì˜ ê²°ê³¼ê°’ì´ ì´ í•¨ìˆ˜ì— ì˜ í˜¸í™˜ ë˜ì§€ì•Šì•„ ì¶”ê°€ì ìœ¼ë¡œ ê±¸ëŸ¬ì£¼ì—ˆìŠµë‹ˆë‹¤.
        return v;
      }
      //ìœ íŠœë¸Œ íƒœê·¸ê°€ ìˆë‹¤ë©´ (ìœ„ì§€ê¸€ì—ë””í„°ê°€ ì œê³µí•˜ì§€ ì•Šì•„ì„œ ì¶”ê°€ì ìœ¼ë¡œ í‚¤ì›Œë“œë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤) iframeìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
      if (v.match(/(#youtube:)/g)) {
        return `<iframe class="youtube" title="YouTube video player" frameborder="0" allow="accelerometer; 
        autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen 
        src="https://www.youtube.com/embed/${v.slice(
          9
        )}"></iframe>`;
      }
      if (v.match(/(#[^\s#+^<]+)/g)) {
        return `<a class="hashtag">${v}</a>`;
      }
      return v;
    });
    const fullContentRemoveComma = post && tagContent?.join("");
    // ë‚˜ì¤‘ì— ì´ ê°’ì€ html parserë¥¼ ì‚¬ìš©í•´ ê²Œì‹œê¸€ì— ë¡œë“œë©ë‹ˆë‹¤.
    fullContentRemoveComma && setFullcontent(fullContentRemoveComma);
  }, [post]);
  
  ...
  
```
---

<br/>

### ğŸ“ &nbsp;  ëŒ“ê¸€ ëŒ€ëŒ“ê¸€ ê·¸ë¦¬ê³  ì¢‹ì•„ìš” êµ¬í˜„.

<br/>

### ğŸ“ &nbsp;  Infinite Scrollì„ êµ¬í˜„.

```javascript
ğŸ“pages/[category]/index.tsx

  useEffect(() => {
    function onScroll() {
      if (
        //Yì¶• ìŠ¤í¬ë¡¤ ê°’ê³¼ í™”ë©´ì— ë³´ì´ëŠ” í˜ì´ì§€ ê¸¸ì´
        window.scrollY + document.documentElement.clientHeight >
        //ì „ì²´ í˜ì´ì§€ì˜ ê¸¸ì´
        document.documentElement.scrollHeight - 300
      ) {
        if (hasMorePosts && !loadMorePostsLoading && (techPosts || dailyPosts.length > 6)) {
          //í¬ìŠ¤íŠ¸ê°€ ë” ìˆê³  , í¬ìŠ¤íŠ¸ë¥¼ ë¡œë”©ì¤‘ì´ ì•„ë‹ˆê³  , í¬ìŠ¤íŠ¸ê°€ 6ê°œ ì´ˆê³¼ì´ë©´ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
          //6ê°œì”© ê°’ì„ ê°€ì ¸ì˜¤ëŠ”ë° 6ê°œë³´ë‹¤ ì•ˆëœë‹¤ë©´ ë‹¹ì—°íˆ ê°’ì„ ì „ë¶€ ê°€ì ¸ì˜¨ê²ƒì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
          const LastId =
            (techPosts || dailyPosts) &&
            (techPosts || dailyPosts)[(techPosts || dailyPosts).length - 1].id;
            // ì´ë¯¸ ë¶ˆëŸ¬ì˜¨ í¬ìŠ¤íŠ¸ë“¤(ë°°ì—´)ì— ë§ˆì§€ë§‰ê°’ì˜ ì•„ì´ë””ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
          dispatch({
            type: LOAD_MORE_POSTS_REQUEST,
            data: {
              LastId,
              category,
            },
          });
        }
      }
    }
    window.addEventListener("scroll", onScroll);
    return () => {
      //ë©”ëª¨ë¦¬ë¦­ì„ ë°©ì§€í•˜ê¸°ìœ„í•´ unmountì‹œ removeEventListner
      window.removeEventListener("scroll", onScroll);
    };
  }, [hasMorePosts, loadCategoryPostsLoading, techPosts, dailyPosts]);

```

```javascript
ğŸ“server/routes/post.js

router.get("/morepost/:category", async (req, res) => {
  try {
    const category = req.params.category;
    let where = {
      //Last ID ë³´ë‹¤ ë‚®ì€ ì¦‰, ì´ì „ê²Œì‹œë¬¼ë“¤ì„ ì°¾ìŠµë‹ˆë‹¤.
      [Op.and]: [{ id: { [Op.lt]: parseInt(req.query.lastId, 10) } }, { category }],
    };
    const morePosts = await Post.findAll({
      //6ê°œì”© ë¶ˆëŸ¬ì˜¤ê³  ê²Œì‹œë‚ ì§œë¥¼ ë‚´ë¦¼ì°¨ë¡œ ì •ë ¬
      where,
      limit: 6,
      order: [["createdAt", "DESC"]],
      include: [
        //í•´ì‹œíƒœê·¸, ì¢‹ì•„ìš”í•œ ìœ ì €ê°€ í•„ìš”í•¨ìœ¼ë¡œ ë°›ì•„ì˜µë‹ˆë‹¤.
        {
          model: Hashtag,
          attributes: ["name"],
        },
        {
          model: User,
          as: "PostLikers",
          attributes: ["id"],
        },
      ],
    });
    res.status(200).json({ morePosts, category });
  } catch (error) {
    console.error(error);
  }
});

```

```javascript
ğŸ“@reducers/post.ts

      ...
    
      case LOAD_MORE_POSTS_SUCCESS:
        draft.loadMorePostsLoading = false;
        draft.loadMorePostsDone = true;
        //ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” í¬ìŠ¤íŠ¸ë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.
        const moreTechPosts =
          action.data.category === "tech" && draft.techPosts.concat(action.data.morePosts);
        const moreDailyPosts =
          action.data.category === "daily" && draft.dailyPosts.concat(action.data.morePosts);
        draft.techPosts = moreTechPosts;
        draft.dailyPosts = moreDailyPosts;
        //ë¶ˆëŸ¬ì˜¨ í¬ìŠ¤íŠ¸ê°€ limitê°’ì¸ 6ê°œë¼ëŠ”ê²ƒì€ ë¶ˆëŸ¬ì˜¨ í¬ìŠ¤íŠ¸ê°€ ë” ìˆë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
        //ë§Œì•½ ê°¯ìˆ˜ê°€ ë”± ë§ì•„ì„œ ë‹¤ìŒ ê°’ì´ ì—†ë‹¤ê³  í•´ë„ ê·¸ ìš”ì²­ì€ 0ê°œì„ìœ¼ë¡œ falseê°€ ë©ë‹ˆë‹¤.
        draft.hasMorePosts = action.data.morePosts.length === 6;
        break;
        
      ...

```
---

<br/>

### ğŸ“ &nbsp;  ëœë¤ í€´ì¦ˆ êµ¬í˜„.

```javascript
ğŸ“class/QuizForm.tsx
  
  const onClickNextQuiz = useCallback(() => {
    //ì´ í€´ì¦ˆ ê°¯ìˆ˜ì¤‘ í•˜ë‚˜ë¥¼ ëœë¤ìœ¼ë¡œ ë½‘ì•„ì˜µë‹ˆë‹¤.
    let myRandNum = Math.floor(Math.random() * quizzes.length);
    //ë§Œì•½ ëœë¤ìœ¼ë¡œ ë½‘ì€ ê°’ì´ í˜„ì¬ê°’ì´ë‘ ì¼ì¹˜í•œë‹¤ë©´...
    if (myRandNum === randomQuiz) {
      //2. ëœë¤ìœ¼ë¡œ ë½‘ì€ê°’ì´ ë§ˆì§€ë§‰ê°’ì¸ ìƒíƒœì—ì„œ +1 ì„ í•˜ê²Œ ë˜ë©´ ì˜¤ë¥˜ê°€ ë‚˜ê²Œ ë˜ê¸° ë•Œë¬¸ì—
      //   ì²«ë²ˆì§¸ ê°’ìœ¼ë¡œ ë³€ê²½í•´ì„œ ë¦¬í„´í•´ì¤ë‹ˆë‹¤.
      if (myRandNum === quizzes.length - 1) {
        setRandomQuiz(0);
        setViewQuizAnswer(false);
        setQuizAnswer("");
        return;
      }
      //1. ëœë¤ìœ¼ë¡œ ë½‘ì€ ê°’ì˜ ë‹¤ìŒê°’ì„ ë¦¬í„´í•©ë‹ˆë‹¤.
      setRandomQuiz(myRandNum + 1);
      setViewQuizAnswer(false);
      setQuizAnswer("");
      return;
    }
    setRandomQuiz(myRandNum);
    setViewQuizAnswer(false);
    setQuizAnswer("");
  }, [quizzes.length, randomQuiz, setQuizAnswer]);

  const onClickQuizSubmit = useCallback(() => {
    //í€´ì¦ˆì— ê°’ì„ ë„£ì§€ ì•Šì•˜ë‹¤ë©´ ì œì¶œë²„íŠ¼ì´ ì‘ë™í•˜ì§€ ì•Šê²Œ í•©ë‹ˆë‹¤.
    if (quizAnswer === "") {
      message.error("ç­”ãˆã‚’æ›¸ã„ã¦ãã ã•ã„ã­ï¼");
      return;
    }
    setViewQuizAnswer(true);
  }, [quizAnswer]);

  ...
 
```
---

<br/>

### ğŸ“ &nbsp;  ìœ ì € ì•„ì´ì½˜ì„ ìœ„í•œ ì´ë¯¸ì§€ ì—…ë¡œë“œì™€ ì´ë¯¸ì§€ Crop ê¸°ëŠ¥ì„ êµ¬í˜„.

```javascript
ğŸ“profile/CropImageModal.tsx

  const handleOk = useCallback(() => {
    //5. blob ê°ì²´ì™€ user idë¥¼ ì„œë²„ì— ìš”ì²­í•˜ê¸°ìœ„í•´ formì„ ë§Œë“­ë‹ˆë‹¤.
    const form = new FormData();
    form.append("image", blob!);
    form.append("id", String(user?.id));
    dispatch({
      type: ADD_ICON_REQUEST,
      data: form,
    });
    setIsModalVisible(false);
    setUrl("");
    setUpImg(null);
  }, []);

  ...

  const onSelectFile = (e: React.ChangeEvent<HTMLInputElement>) => {
    //1-1. React-crop ê³µì‹ë¬¸ì„œë¥¼ ì°¸ì¡°í–ˆìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•´ì¤ë‹ˆë‹¤.
    if (e.target.files && e.target.files.length > 0) {
      const reader = new FileReader();
      reader.addEventListener("load", () => setUpImg(reader.result));
      reader.readAsDataURL(e.target.files[0]);
    }
  };

  const onLoad = useCallback((img) => {
    imgRef.current = img;
  }, []);

  useEffect(() => {
    //3. React-crop ê³µì‹ë¬¸ì„œë¥¼ ì°¸ì¡°í–ˆìŠµë‹ˆë‹¤. canvasì— ìë¥¸ ì´ë¯¸ì§€ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
    if (!completedCrop || !previewCanvasRef.current || !imgRef.current) {
      return;
    }
    const image: any = imgRef.current;
    const canvas: any = previewCanvasRef.current;

    ...
    
    );
    new Promise(() => {
      canvas.toBlob(
        //4. ìë¥¸ ì´ë¯¸ì§€ë¥¼ Blob ê°ì²´ë¡œ ë°”ê¿” stateì— ì €ì¥í•©ë‹ˆë‹¤.
        (blob: Blob) => {
          setBlob(blob);
        },
        "image/png",
        1
      );
    });
  }, [completedCrop]);

  return (
    {/* 0. Icon ìˆ˜ì • (+ Crop Image)ëŠ” Modalì°½ì—ì„œ ì¼ì–´ë‚˜ë©° Modalì€ Antdë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. */}
    <Modal title="Icon Upload ğŸ–¼ï¸" visible={isModalVisible} onOk={handleOk} onCancel={handleCancel}>
      <h3>Set icon from Local storage</h3>
      {/* 1. Urlì„ ì´ìš©í•´ ì•„ì´ì½˜ì„ ì—…ë¡œë“œí• ì§€, fileì„ ì´ìš©í• ì§€ ì„ íƒí•©ë‹ˆë‹¤. */}
      <input
        style={{ marginBottom: "1.5rem" }}
        type="file"
        accept="image/*"
        disabled={url ? true : false}
        onChange={onSelectFile}
      />
      <h3>Set icon by using URL</h3>
      <Input
        disabled={upImg ? true : false}
        value={url}
        onChange={onChangeUrl}
        placeholder="https://"
      />

      {(url || upImg) && (
        <>
          {/* 2. ì˜¬ë¦° ì´ë¯¸ì§€ë¥¼ í™œìš©í•´ ì´ë¯¸ì§€ë¥¼ ìë¦…ë‹ˆë‹¤. */}
          <h3>Crop the image for icon size.</h3>
          <ReactCrop
            crossorigin="anonymous"
            
            ...

```
---

<br/>

### ğŸ“ &nbsp;  ì´ë¯¸ì§€ëŠ” multerë¥¼ ì‚¬ìš©í•´ AWS-S3ì— ì €ì¥.
  
```javascript
ğŸ“server/routes/user.js

// ì•„ì´ì½˜ ì´ë¯¸ì§€ë¥¼ ì„œë²„ì—ì„œ ì—…ë¡œë“œí•˜ëŠ” ê³¼ì •.

const upload = multer({
  storage: multerS3({
    // AWS.S3ì— ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.
    s3: new AWS.S3(),
    bucket: "noahworld",
    key(req, file, cb) {
      cb(null, `original/${Date.now()}_${path.basename(file.originalname)}`);
    },
  }),
  limits: { fileSize: 20 * 1024 * 1024 },
});

router.post("/icon", upload.single("image"), async (req, res, next) => {
  //ìœ ì €ê°€ fileì„ ì—…ë¡œë“œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì•„ì´ì½˜ì„ ì—…ë°ì´íŠ¸í•œ ê²½ìš°
  User.update(
    { icon: req.file.location.replace(/\/original\//, "/thumb/") },
    { where: { id: req.body.id } }
  );
  res.json(req.file.location.replace(/\/original\//, "/thumb/"));
});

router.post("/icon/url", async (req, res, next) => {
  //ìœ ì €ê°€ urlì„ ì´ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì•„ì´ì½˜ì„ ì—…ë°ì´íŠ¸í•œ ê²½ìš°
  User.update({ icon: req.body.url }, { where: { id: req.body.UserId } });
  res.json(req.body.url);
});

router.delete("/icon/:UserId", async (req, res, next) => {
  //ìœ ì €ê°€ ì•„ì´ì½˜ì„ ì‚­ì œí•˜ëŠ”ê²½ìš°, ë¯¸ë¦¬ ì €ì¥ë˜ì–´ìˆëŠ” default ê°’ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
  User.update(
    { icon: "/images/blog/default-user.png" },
    { where: { id: parseInt(req.params.UserId, 10) } }
  );
  res.send({ success: true });
});

```
---

### ğŸ“ &nbsp; ê·¸ì™¸...

- Reduxì— Redux Sagaë¥¼ ì¶”ê°€í•´ ë¹„ë™ê¸°ë¥¼ êµ¬í˜„í•˜ê³  immerë¥¼ ì ìš©í•´ ë¶ˆë³€ì„± ì¤€ìˆ˜ì˜ ë¶ˆí¸í•¨ì„ í•´ì†Œ.
- cors ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•´ ê¸°ë³¸ì ì¸ ë¸Œë¼ìš°ì €-í”„ë¡ íŠ¸ì„œë²„-ë°±ì„œë²„ê°„ cors ë¬¸ì œë¥¼ í•´ê²°.
- Passport.jsì™€ Google Login APIë¥¼ í™œìš©í•œ ë¡œê·¸ì¸ ë° ìœ ì§€ê¸°ëŠ¥ êµ¬í˜„.
- bcrypt, node-helmet, https, dot-env, ì¿ í‚¤ì˜ secretê³¼ expires, Admin ì „ìš© ë¹„ë°€ë²ˆí˜¸, ë¯¼ê°í•œì •ë³´ í´ë¼ì´ì–¸íŠ¸ ì·¨ê¸‰ X, ì˜ˆì™¸ì²˜ë¦¬ë“±ìœ¼ë¡œ ì›¹ë³´ì•ˆì„ ì¤€ìˆ˜í•˜ë„ë¡ ë…¸ë ¥í–ˆìŠµë‹ˆë‹¤. 

<br/>

## Retrospective & Feedback 

<br/>

1. ê³„íšê³¼ëŠ” ë‹¤ë¥¸ í”„ë¡œì íŠ¸ê°€ ë˜ì—ˆê³  ì°¨ì§ˆì´ ë§ì•˜ìŠµë‹ˆë‹¤. ì´ˆë°˜ì— ì²´ê³„ì ì¸ ê³„íšì´ ëŠ¥ë¥ ì„ ë†’ì¸ë‹¤ëŠ”ê²ƒì„ ì ˆì‹¤íˆ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤.

2. ìŠ¤íƒ€ì¼ì‹œíŠ¸ë¥¼ ê³„íšì ì´ê²Œ ì§œì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë˜í•œ ë³€ìˆ˜ëª…ì— ì‹ ê²½ì„ ì˜ ì¨ì•¼ë¨ì„ ëŠê¼ˆìŠµë‹ˆë‹¤.

3. HTTP ì§€ì‹ì´ ë§ì´ ë¶€ì¡±í•˜ë‹¤ê³  ëŠê¼ˆê³  ì •ë³´ì²˜ë¦¬ê¸°ì‚¬ ì‹œí—˜ ë° ê°•ì˜ë¥¼ í†µí•´ ë³´ì¶©í–ˆìŠµë‹ˆë‹¤.

4. **ì—¬ê¸°ì— ì ê¸°ì—” í„±ì—†ì´ ë¶€ì¡±í• ë§Œí¼ ë„˜ì—ˆë˜ ì‚°ì´ ë§ì•˜ë˜ ë¬´ë¦¬í•œ í”„ë¡œì íŠ¸ì˜€ì§€ë§Œ ê·¸ë ‡ê¸°ì— ê³µë¶€ê°€ ì •ë§ ì˜ëœ.. í•œë§ˆë””ë¡œ ë§¨ë•…ì— í•´ë”©í•´ì„œ ë‚˜ë¦„ ì„±ê³µí•œ í”„ë¡œì íŠ¸ì˜€ìŠµë‹ˆë‹¤.**

<br/><br/>

## Thank you for taking your time.

<br/>

í”¼ë“œë°±ì€ í•­ìƒ ì €ë¥¼ ì„±ì¥ì‹œí‚¤ê²Œ í•©ë‹ˆë‹¤.

ê¶ê¸ˆí•œê²Œ ìˆìœ¼ì‹œë©´ noah071610@naver.com ìœ¼ë¡œ ì–¸ì œë“ ì§€ í¸í•˜ê²Œ ì—°ë½ì£¼ì„¸ìš”.

ì§€ê¸ˆê¹Œì§€ ì‹ ë¢°ë¥¼ ì£¼ëŠ” ì¥í˜„ìˆ˜ì˜€ìŠµë‹ˆë‹¤. ê¸´ê¸€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.


<br/><br/><br/><br/>
